<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.csu.sfteam.house.biz.mapper.UserMapper">

    <select id="getUsers" parameterType="string" resultType="user ">
        select
        user_important.realname, IDnumber, pw, email,
        user_standrad.ID, username, type, info, icon, sex, address, tele
        from user_important, user_standrad
        where user_standrad.ID = user_important.ID
        and user_important.email = #{email}
        and user_important.pw = #{pw}
    </select>

    <insert id="addToCollection">
        insert into user_collections (
               userid, itemid, time
               )
               values(
               #{userID},
               #{itemID},
               #{time}
               )
        )
    </insert>

    <insert id="insert">
        insert into user_important (
                ID, realname, IDnumber, pw, email
                )
                values(
                #{ID},
                #{realname},
                #{IDnumber},
                #{pw}
                );
        insert into user_standrad (
                ID, username, type, email, info, icon, sex, address, tele
                )
                values(
                #{ID},
                #{username},
                #{type},
                #{email},
                #{info},
                #{icon},
                #{sex},
                #{address},
                #{tele}
                );
    </insert>

    <delete id="delete" parameterType="string">
        delete from user_standrad
        where ID=#{ID};
        delete from user_important
        where ID=#{ID};
    </delete>

    <delete id="delete" parameterType="user">
        delete from user_standrad
        where ID=#{ID};
        delete from user_important
        where ID=#{ID};
    </delete>

    <update id="update">
        update user_standrad
        <set>
            <if test="email !=null and email != '' ">
                email = #{email},
            </if>
            <if test="info !=null and info != '' ">
                info = #{info},
            </if>
            <if test="icon !=null and icon != '' ">
                icon = #{icon},
            </if>
            <if test="address !=null ">
                address = #{address},
            </if>
            <if test="tele != null">
                tele = #{tele}
            </if>
        </set>
        where ID = #{ID}
    </update>

    <select id="selectUserCount" resultType="long">
        select count(*)
        from user_important
    </select>
</mapper>